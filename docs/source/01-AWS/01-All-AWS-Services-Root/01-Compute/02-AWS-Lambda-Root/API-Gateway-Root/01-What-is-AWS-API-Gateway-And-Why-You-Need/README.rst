What is AWS API Gateway And Why You Need
==============================================================================

.. contents::
    :class: this-will-duplicate-information-and-it-is-still-useful-here
    :depth: 1
    :local:


Why you need API Gateway
------------------------------------------------------------------------------

.. contents::
    :class: this-will-duplicate-information-and-it-is-still-useful-here
    :depth: 1
    :local:


Why you HAVE TO use API Gateway in Microservice Architect?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. **Service Aggregation**. Without API Gateway (Amazon Product Page Example):
    - One page need to call many backend service. some services go Public network, some services should go internal Private network, different backend services may use different Protocol, HTTP / RPC / AMQP. Some take longer, some services is faster. Some may fail. How could you handle this level complexity on client side? We want to leave client a simple, clean API to use.
    - If you update the backend service, you have to update the client. It is super difficult to ask your user to keep the client up-to-date.
2. **Protect Your Backend Service**. Without API Gateway (DDOS Example, Database Backend Example):
    - A simple DDOS attack can easily break your service.
    - You need to those module for all of your services:
        1. throttling mechanism to protect your backend service
        2. API request Cache
        3. CDN (content delivery network)
        4. Custom authentication
        5. request / response metrics monitoring
        6. Client track


Benefits using API Gateway in Microservice Architect?
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
1. **Service Discovery**: Backend service endpoint may change, it's hard for client to know what services are available and what is the service endpoint.
2. **Handle Local Failure**: Amazon Recommendation system example, customized recommendation may fail, but Top 10 popular is always available.



AWS API Gateway FAQ
------------------------------------------------------------------------------
Ref:

- https://aws.amazon.com/api-gateway/faqs/

- Q: **What happens if a large number of end users try to invoke my API simultaneously?**, 高并发时会发生什么?
- A: **If caching is not enabled and throttling limits have not been applied, then all requests will pass through to your backend service until the account level throttling limits are reached**. If throttling limits are in place, then Amazon API Gateway will shed the necessary amount of requests and send only the defined limit to your back-end service. If a cache is configured, then Amazon API Gateway will return a cached response for duplicate requests for a customizable time, but only if under configured throttling limits. This balance between the backend and client ensures optimal performance of the APIs for the applications that it supports. Requests that are throttled will be automatically retried by the client-side SDKs generated by Amazon API Gateway. **By default, Amazon API Gateway does not set any cache on your API methods**.

- Q: **How do APIs scale?**
- A: Amazon API Gateway acts as a proxy to the backend operations that you have configured. **Amazon API Gateway will automatically scale to handle the amount of traffic your API receives**. Amazon API Gateway does not arbitrarily limit or throttle invocations to your backend operations and all requests that are not intercepted by throttling and caching settings in the Amazon API Gateway console are sent to your backend operations.